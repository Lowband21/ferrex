{
  "db_name": "PostgreSQL",
  "query": "\n            WITH inprog AS (\n                SELECT media_uuid, media_type, position, duration, last_watched\n                FROM user_watch_progress\n                WHERE user_id = $1\n                  AND position > 0\n                  AND (duration > 0) AND (position / duration) < 0.95\n            )\n            SELECT * FROM (\n                SELECT\n                    mr.id AS \"id!\",\n                    mf.id AS \"file_id!\",\n                    inprog.position::real AS \"position!\",\n                    inprog.duration::real AS \"duration!\",\n                    inprog.last_watched::bigint AS \"last_watched!\",\n                    0::int4                  AS \"media_kind!\"\n                FROM inprog\n                JOIN movie_references mr ON inprog.media_uuid = mr.id AND inprog.media_type = 0\n                JOIN media_files mf ON mr.file_id = mf.id\n\n                UNION ALL\n\n                SELECT\n                    er.id              AS \"id!\",\n                    mf.id              AS \"file_id!\",\n                    inprog.position::real AS \"position!\",\n                    inprog.duration::real AS \"duration!\",\n                    inprog.last_watched::bigint AS \"last_watched!\",\n                    3::int4                  AS \"media_kind!\"\n                FROM inprog\n                JOIN episode_references er ON inprog.media_uuid = er.id AND inprog.media_type = 3\n                JOIN media_files mf ON er.file_id = mf.id\n            ) AS inprog_rows\n            ORDER BY inprog_rows.\"last_watched!\" DESC\n            LIMIT $2 OFFSET $3\n            ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "id!",
        "type_info": "Uuid"
      },
      {
        "ordinal": 1,
        "name": "file_id!",
        "type_info": "Uuid"
      },
      {
        "ordinal": 2,
        "name": "position!",
        "type_info": "Float4"
      },
      {
        "ordinal": 3,
        "name": "duration!",
        "type_info": "Float4"
      },
      {
        "ordinal": 4,
        "name": "last_watched!",
        "type_info": "Int8"
      },
      {
        "ordinal": 5,
        "name": "media_kind!",
        "type_info": "Int4"
      }
    ],
    "parameters": {
      "Left": [
        "Uuid",
        "Int8",
        "Int8"
      ]
    },
    "nullable": [
      null,
      null,
      null,
      null,
      null,
      null
    ]
  },
  "hash": "3d398c2b6220a12d9dc4bc7296d11fac9e8b286a2c796c569a8de86306e43f7a"
}
